<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic|Noto Serif SC:300,300italic,400,400italic,700,700italic|Source Code Pro:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-big-counter.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"framist.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="【moeCTF题解-0x04】Crypto有多少信息熵，就能还原出多少信息  信息熵&#x3D;    现代密码学知识没学多少，倒是把Classic Crypto部分AK惹……">
<meta property="og:type" content="article">
<meta property="og:title" content="【moeCTF题解-0x04】Crypto">
<meta property="og:url" content="https://framist.github.io/2020/10/12/%E3%80%90moeCTF%E9%A2%98%E8%A7%A3-0x04%E3%80%91Crypto/index.html">
<meta property="og:site_name" content="Framist&#39;s Little House">
<meta property="og:description" content="【moeCTF题解-0x04】Crypto有多少信息熵，就能还原出多少信息  信息熵&#x3D;    现代密码学知识没学多少，倒是把Classic Crypto部分AK惹……">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=-%5Csum_%7Bi=1%7D%5E%7Bn%7Dp_i%5Clog_%7B2%7Dp_i">
<meta property="og:image" content="https://bkimg.cdn.bcebos.com/formula/f0dac18152076624d87832b62709895c.svg">
<meta property="og:image" content="https://bkimg.cdn.bcebos.com/formula/c33d8c66364a636b051d82f0ee202a36.svg">
<meta property="og:image" content="https://bkimg.cdn.bcebos.com/formula/da8649c0078a0a842779394d64011776.svg">
<meta property="og:image" content="https://bkimg.cdn.bcebos.com/formula/4dee3f4df52a81983db0e3c619f96058.svg">
<meta property="og:image" content="https://bkimg.cdn.bcebos.com/formula/679e809a0d964785d0aa4cfcb4218742.svg">
<meta property="og:image" content="https://bkimg.cdn.bcebos.com/formula/5947116555169dc6fe9e3f5cdf347706.svg">
<meta property="og:image" content="https://bkimg.cdn.bcebos.com/formula/1a8b337167e4d4b2c23855d88ec4c67f.svg">
<meta property="og:image" content="https://bkimg.cdn.bcebos.com/formula/3da31f29a8615a130216bdf28ccf3321.svg">
<meta property="og:image" content="https://bkimg.cdn.bcebos.com/formula/ba40ed514646510df8a1033ff30701aa.svg">
<meta property="og:image" content="https://bkimg.cdn.bcebos.com/formula/b843a8b241f76d7068e96630fc384bb9.svg">
<meta property="og:image" content="https://bkimg.cdn.bcebos.com/formula/312031d1a76fa578eb4ef166530937fa.svg">
<meta property="og:image" content="https://bkimg.cdn.bcebos.com/formula/5047f2bc6e623027b7707e6c51adc92f.svg">
<meta property="og:image" content="https://bkimg.cdn.bcebos.com/formula/25e9558d577009b1b8b56f9a103b2321.svg">
<meta property="article:published_time" content="2020-10-12T15:04:30.492Z">
<meta property="article:modified_time" content="2020-11-06T09:13:24.949Z">
<meta property="article:author" content="Framist">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="Crypto">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.zhihu.com/equation?tex=-%5Csum_%7Bi=1%7D%5E%7Bn%7Dp_i%5Clog_%7B2%7Dp_i">

<link rel="canonical" href="https://framist.github.io/2020/10/12/%E3%80%90moeCTF%E9%A2%98%E8%A7%A3-0x04%E3%80%91Crypto/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>【moeCTF题解-0x04】Crypto | Framist's Little House</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Framist's Little House</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">◇ 自顶而下 - 面向未来 ◇</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://framist.github.io/2020/10/12/%E3%80%90moeCTF%E9%A2%98%E8%A7%A3-0x04%E3%80%91Crypto/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Framist">
      <meta itemprop="description" content="框架主义者的小窝">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Framist's Little House">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          【moeCTF题解-0x04】Crypto
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-10-12 23:04:30" itemprop="dateCreated datePublished" datetime="2020-10-12T23:04:30+08:00">2020-10-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-11-06 17:13:24" itemprop="dateModified" datetime="2020-11-06T17:13:24+08:00">2020-11-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/moeCTF/" itemprop="url" rel="index"><span itemprop="name">moeCTF</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="【moeCTF题解-0x04】Crypto"><a href="#【moeCTF题解-0x04】Crypto" class="headerlink" title="【moeCTF题解-0x04】Crypto"></a>【moeCTF题解-0x04】Crypto</h1><p><em>有多少信息熵，就能还原出多少信息</em></p>
<blockquote>
<p>信息熵=<img src="https://www.zhihu.com/equation?tex=-%5Csum_%7Bi=1%7D%5E%7Bn%7Dp_i%5Clog_%7B2%7Dp_i" alt="[公式]"></p>
</blockquote>
<br>

<p>现代密码学知识没学多少，倒是把Classic Crypto部分AK惹……</p>
<a id="more"></a>

<br>

<blockquote>
<p><strong>【moeCTF题解】总目录如下：</strong></p>
<ul>
<li><p><a href="https://framist.github.io/2020/10/09/%E3%80%90moeCTF%E9%A2%98%E8%A7%A3-0x00%E3%80%91%E5%BA%8F/">【moeCTF题解-0x00】序                （包括Sign in）</a></p>
</li>
<li><p><a href="https://framist.github.io/2020/10/09/%E3%80%90moeCTF%E9%A2%98%E8%A7%A3-0x01%E3%80%91Reverse/">【moeCTF题解-0x01】Reverse      （包括Android、IoT）</a></p>
</li>
<li><p><a href="https://framist.github.io/2020/10/09/%E3%80%90moeCTF%E9%A2%98%E8%A7%A3-0x02%E3%80%91Pwn/">【moeCTF题解-0x02】Pwn</a></p>
</li>
<li><p><a href="https://framist.github.io/2020/10/12/%E3%80%90moeCTF%E9%A2%98%E8%A7%A3-0x03%E3%80%91Algorithm/">【moeCTF题解-0x03】Algorithm</a></p>
</li>
<li><p><a href="https://framist.github.io/2020/10/12/%E3%80%90moeCTF%E9%A2%98%E8%A7%A3-0x04%E3%80%91Crypto/">【moeCTF题解-0x04】Crypto          （包括 Classic Crypto）</a></p>
</li>
<li><p><a href="https://framist.github.io/2020/10/15/%E3%80%90moeCTF%E9%A2%98%E8%A7%A3-0x05%E3%80%91Misc/">【moeCTF题解-0x05】Misc</a></p>
</li>
<li><p><a href="https://framist.github.io/2020/10/25/%E3%80%90moeCTF%E9%A2%98%E8%A7%A3-0x06%E3%80%91Web/">【moeCTF题解-0x06】Web</a></p>
</li>
</ul>
</blockquote>
<br>






<h1 id="Classic-Crypto"><a href="#Classic-Crypto" class="headerlink" title="Classic Crypto"></a>Classic Crypto</h1><p>6/6</p>
<h2 id="大帝的征程-1"><a href="#大帝的征程-1" class="headerlink" title="大帝的征程#1"></a>大帝的征程#1</h2><blockquote>
<p>50points</p>
<p><code>zbrpgs&#123;p0adh3e_gu3_j0eyq&#125;</code></p>
</blockquote>
<p>有关密码的大帝就是凯撒大帝啦</p>
<p>随便搞一个凯撒密码解密程序：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">plaintext</span>):</span></span><br><span class="line">	<span class="comment"># j即为key</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">26</span>):</span><br><span class="line">        str_list = list(plaintext)</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> i &lt;len(plaintext):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> str_list[i].isalpha():</span><br><span class="line">                str_list[i] = str_list[i]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                a = <span class="string">&quot;A&quot;</span> <span class="keyword">if</span> str_list[i].isupper() <span class="keyword">else</span> <span class="string">&quot;a&quot;</span></span><br><span class="line">                str_list[i] = chr((ord(str_list[i]) - ord(a) + j) % <span class="number">26</span> + ord(a))</span><br><span class="line">            i = i + <span class="number">1</span></span><br><span class="line">        print(<span class="string">&#x27;&#x27;</span>.join(str_list))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    plaintext = <span class="string">&quot;pgieqi&#123;k0_ajxW_k-R3zq?&#125;&quot;</span></span><br><span class="line">    encrypt(plaintext)</span><br></pre></td></tr></table></figure>

<p>输出如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">zbrpgs&#123;p0adh3e_gu3_j0eyq&#125;</span><br><span class="line">acsqht&#123;q0bei3f_hv3_k0fzr&#125;</span><br><span class="line">bdtriu&#123;r0cfj3g_iw3_l0gas&#125;</span><br><span class="line">ceusjv&#123;s0dgk3h_jx3_m0hbt&#125;</span><br><span class="line">dfvtkw&#123;t0ehl3i_ky3_n0icu&#125;</span><br><span class="line">egwulx&#123;u0fim3j_lz3_o0jdv&#125;</span><br><span class="line">fhxvmy&#123;v0gjn3k_ma3_p0kew&#125;</span><br><span class="line">giywnz&#123;w0hko3l_nb3_q0lfx&#125;</span><br><span class="line">hjzxoa&#123;x0ilp3m_oc3_r0mgy&#125;</span><br><span class="line">ikaypb&#123;y0jmq3n_pd3_s0nhz&#125;</span><br><span class="line">jlbzqc&#123;z0knr3o_qe3_t0oia&#125;</span><br><span class="line">kmcard&#123;a0los3p_rf3_u0pjb&#125;</span><br><span class="line">lndbse&#123;b0mpt3q_sg3_v0qkc&#125;</span><br><span class="line">moectf&#123;c0nqu3r_th3_w0rld&#125;     &lt;-- 好耶ヾ(✿ﾟ▽ﾟ)ノ是这个</span><br><span class="line">npfdug&#123;d0orv3s_ui3_x0sme&#125;</span><br><span class="line">oqgevh&#123;e0psw3t_vj3_y0tnf&#125;</span><br><span class="line">prhfwi&#123;f0qtx3u_wk3_z0uog&#125;</span><br><span class="line">qsigxj&#123;g0ruy3v_xl3_a0vph&#125;</span><br><span class="line">rtjhyk&#123;h0svz3w_ym3_b0wqi&#125;</span><br><span class="line">sukizl&#123;i0twa3x_zn3_c0xrj&#125;</span><br><span class="line">tvljam&#123;j0uxb3y_ao3_d0ysk&#125;</span><br><span class="line">uwmkbn&#123;k0vyc3z_bp3_e0ztl&#125;</span><br><span class="line">vxnlco&#123;l0wzd3a_cq3_f0aum&#125;</span><br><span class="line">wyomdp&#123;m0xae3b_dr3_g0bvn&#125;</span><br><span class="line">xzpneq&#123;n0ybf3c_es3_h0cwo&#125;</span><br><span class="line">yaqofr&#123;o0zcg3d_ft3_i0dxp&#125;</span><br></pre></td></tr></table></figure>



<p>得到flag：<code>moectf&#123;c0nqu3r_th3_w0rld&#125;</code></p>
<p><em>Ps. 可检测字符是否含有字符串来抑制输出</em></p>
<br>

<h2 id="大帝的征程-2"><a href="#大帝的征程-2" class="headerlink" title="大帝的征程#2"></a>大帝的征程#2</h2><blockquote>
<p>75points</p>
<p><code>mpgfxk&#123;j8w05q4_8xk_d7mhqfht&#125;</code></p>
<p>免费hint：<code>table = &#39;abcdefghijklmnopqrstuvwxyz0123456789&#39;</code></p>
</blockquote>
<p>开了hint后就知道是凯撒密码的换表</p>
<p>于是修改上面那个程序如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">plaintext</span>):</span></span><br><span class="line">    symbols = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyz0123456789&#x27;</span></span><br><span class="line">	<span class="comment"># j即为key</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(len(symbols)):</span><br><span class="line">        str_list = list(plaintext)</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> i &lt;len(plaintext):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> str_list[i].isalnum():</span><br><span class="line">                str_list[i] = str_list[i]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line"></span><br><span class="line">                <span class="comment"># str_list[i] = chr((ord(str_list[i]) - ord(a) + j - i) % 26 + ord(a))</span></span><br><span class="line">                str_list[i] = symbols[(symbols.find(str_list[i]) + j - i) % len(symbols) ]</span><br><span class="line">            i = i + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        print(<span class="string">&#x27;&#x27;</span>.join(str_list))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    plaintext = <span class="string">&quot;mpgfxk&#123;j8w05q4_8xk_d7mhqfht&#125;&quot;</span></span><br><span class="line">    encrypt(plaintext)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出第一行就是flag：<code>moectf&#123;c0nquer_th3_un1v3rs3&#125;</code></p>
<br>



<h2 id="外面的世界"><a href="#外面的世界" class="headerlink" title="外面的世界"></a>外面的世界</h2><blockquote>
<p>75points</p>
<p>外面的世界很精彩~</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mc&#123;i33ny_-n~otR1n_cp1FN&#125;efaFc32Tsuy</span><br></pre></td></tr></table></figure>

<p>flag请准确提交</p>
</blockquote>
<p>这个就根据关键词moectf直接看出来了，手撕解密：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mc&#123;i33ny_-n~</span><br><span class="line">otR1n_cp1FN&#125;</span><br><span class="line">efaFc32Tsuy</span><br></pre></td></tr></table></figure>

<p>得到flag：<code>moectf&#123;Rai1F3nc3_3nc2ypT_1s-FunNy~&#125;</code></p>
<p><del>其实是不知道栅栏密码</del></p>
<br>

<p>更好的方法：引用<code>吉吉</code>的<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/262761814">WP</a>： </p>
<blockquote>
<p><code>mc&#123;i33ny_-n~otR1n_cp1FN&#125;efaFc32Tsuy</code> 栅栏加密，栏数为 <code>12</code> ，注意需要使用正向加密算法</p>
<p>因此flag为 <code>moectf&#123;Rai1F3nc3_3nc2ypT_1s-FunNy~&#125;</code></p>
</blockquote>
<br>

<h2 id="大帝的征程-3"><a href="#大帝的征程-3" class="headerlink" title="大帝的征程#3"></a>大帝的征程#3</h2><blockquote>
<p>100points</p>
<p><code>\&gt;@64E7L4_?BF6C0E9b0)s$trN</code></p>
</blockquote>
<p>猜测字符表是ASCII可打印字符，一试果然是：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># &gt;@64E7L4_?BF6C0E9b0)s$trN</span></span><br><span class="line"><span class="keyword">import</span> string </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">plaintext</span>):</span></span><br><span class="line">    symbols = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>,<span class="number">126</span>):</span><br><span class="line">        symbols = symbols + chr(i)</span><br><span class="line">    print(symbols)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(len(symbols)):</span><br><span class="line">        str_list = list(plaintext)</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> i &lt; len(plaintext):</span><br><span class="line">            str_list[i] = symbols[(symbols.find(str_list[i]) - j ) % len(symbols) ]</span><br><span class="line"></span><br><span class="line">            i = i + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> str_list[<span class="number">0</span>] == <span class="string">&#x27;m&#x27;</span>:</span><br><span class="line">            print(j,<span class="string">&#x27;&#x27;</span>.join(str_list))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"> </span><br><span class="line">    plaintext = <span class="string">&quot;&gt;@64E7L4_?BF6C0E9b0)s$trN&quot;</span></span><br><span class="line">    <span class="comment">#            moectf&#123;c0nquer_th3_XDSEC&#125;</span></span><br><span class="line">    decrypt(plaintext)</span><br></pre></td></tr></table></figure>

<p>得到flag：<code>moectf&#123;c0nquer_th3_XDSEC&#125;</code></p>
<p>更好的方法参考<a href="gitee.com/mmdjiji">吉吉</a>的<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/262761814">WP</a>： </p>
<blockquote>
<p><code>&gt;@64E7L4_?BF6C0E9b0)s$trN</code> 前6位与 <code>moectf</code> 做比较，发现差为 <code>47</code> 于是编写代码</p>
</blockquote>
<br>



<h2 id="大帝的征程-维吉尼亚"><a href="#大帝的征程-维吉尼亚" class="headerlink" title="大帝的征程#维吉尼亚"></a>大帝的征程#维吉尼亚</h2><blockquote>
<p>100points</p>
<p>接下来去哪里呢?</p>
<p>flag请准确填写.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;[Warning] Case Sensitive!</span><br></pre></td></tr></table></figure>
</blockquote>
<p>看到附件文本中的<code>pgieqi&#123;k0_ajxW_k-R3zq?&#125;</code>，应该就是flag了，把<code>pgieqi</code>与<code>moectf</code>比较，可以大致确定秘钥是<code>xdesc</code>，所附解密脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">plaintext</span>):</span></span><br><span class="line">	<span class="comment"># j即为key</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">26</span>):</span><br><span class="line">        str_list = list(plaintext)</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> i &lt;len(plaintext):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> str_list[i].isalpha():</span><br><span class="line">                str_list[i] = str_list[i]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                a = <span class="string">&quot;A&quot;</span> <span class="keyword">if</span> str_list[i].isupper() <span class="keyword">else</span> <span class="string">&quot;a&quot;</span></span><br><span class="line">                str_list[i] = chr((ord(str_list[i]) - ord(a) + j) % <span class="number">26</span> + ord(a))</span><br><span class="line"></span><br><span class="line">            i = i + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        print(chr(j+ord(a)),<span class="string">&#x27;&#x27;</span>.join(str_list))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">plaintext</span>):</span></span><br><span class="line">	<span class="comment"># j即为key</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">26</span>):</span><br><span class="line">        str_list = list(plaintext)</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> i &lt;len(plaintext):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> str_list[i].isalpha():</span><br><span class="line">                str_list[i] = str_list[i]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                a = <span class="string">&quot;A&quot;</span> <span class="keyword">if</span> str_list[i].isupper() <span class="keyword">else</span> <span class="string">&quot;a&quot;</span></span><br><span class="line">                str_list[i] = chr((ord(str_list[i]) - ord(a) - j) % <span class="number">26</span> + ord(a))</span><br><span class="line"></span><br><span class="line">            i = i + <span class="number">1</span></span><br><span class="line">        print(chr(j+ord(a))+<span class="string">&#x27;|&#x27;</span>,<span class="string">&#x27;&#x27;</span>.join(str_list))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">VigenereEncode</span>(<span class="params">message,key</span>):</span></span><br><span class="line">    pLen=len(message)</span><br><span class="line">    kLen=len(key)</span><br><span class="line">    raw = string.ascii_lowercase + string.ascii_uppercase  <span class="comment"># 明文空间</span></span><br><span class="line">    out=<span class="string">&quot;&quot;</span></span><br><span class="line">    ii = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,pLen):</span><br><span class="line">        j=ii%kLen</span><br><span class="line">        <span class="keyword">if</span> message[i] <span class="keyword">not</span> <span class="keyword">in</span> raw:</span><br><span class="line">            out+=message[i]</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            a = <span class="string">&quot;A&quot;</span> <span class="keyword">if</span> message[i].isupper() <span class="keyword">else</span> <span class="string">&quot;a&quot;</span></span><br><span class="line">            encodechr = chr((ord(message[i]) - ord(a) + ( ord(key[j]) - ord(<span class="string">&#x27;a&#x27;</span>) ) ) % <span class="number">26</span> + ord(a))</span><br><span class="line">            ii += <span class="number">1</span></span><br><span class="line">            out+=encodechr</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">VigenereDecode</span>(<span class="params">message,key</span>):</span></span><br><span class="line">    pLen=len(message)</span><br><span class="line">    kLen=len(key)</span><br><span class="line">    raw = string.ascii_lowercase + string.ascii_uppercase  <span class="comment"># 明文空间</span></span><br><span class="line"></span><br><span class="line">    out=<span class="string">&quot;&quot;</span></span><br><span class="line">    ii = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,pLen):</span><br><span class="line">        j=ii%kLen</span><br><span class="line">        <span class="keyword">if</span> message[i] <span class="keyword">not</span> <span class="keyword">in</span> raw:</span><br><span class="line">            out+=message[i]</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            a = <span class="string">&quot;A&quot;</span> <span class="keyword">if</span> message[i].isupper() <span class="keyword">else</span> <span class="string">&quot;a&quot;</span></span><br><span class="line">            encodechr = chr((ord(message[i]) - ord(a) -( ord(key[j]) - ord(<span class="string">&#x27;a&#x27;</span>) )) % <span class="number">26</span> + ord(a))</span><br><span class="line">            ii += <span class="number">1</span></span><br><span class="line">            out+=encodechr</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">VigenereDecode</span>(<span class="params">message,key</span>):</span></span><br><span class="line">    pLen=len(message)</span><br><span class="line">    kLen=len(key)</span><br><span class="line">    raw = string.ascii_lowercase + string.ascii_uppercase  <span class="comment"># 明文空间</span></span><br><span class="line"></span><br><span class="line">    out=<span class="string">&quot;&quot;</span></span><br><span class="line">    ii = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,pLen):</span><br><span class="line">        j=ii%kLen</span><br><span class="line">        <span class="keyword">if</span> message[i] <span class="keyword">not</span> <span class="keyword">in</span> raw:</span><br><span class="line">            out+=message[i]</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            a = <span class="string">&quot;A&quot;</span> <span class="keyword">if</span> message[i].isupper() <span class="keyword">else</span> <span class="string">&quot;a&quot;</span></span><br><span class="line">            encodechr = chr((ord(message[i]) - ord(a) -( ord(key[j]) - ord(<span class="string">&#x27;a&#x27;</span>) )) % <span class="number">26</span> + ord(a))</span><br><span class="line">            ii += <span class="number">1</span></span><br><span class="line">            out+=encodechr</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    raw = string.ascii_lowercase + string.ascii_uppercase</span><br><span class="line">    text = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Qkjswdkgyv elkxqob, eepv gajhbuwrv hlfkflpk lcsh jmubq srf cddpgk; psra bphmtbv zexb ewip yrjr qrw gj plwzmpd dfh vehf gqiostubg ls trlf. Qckb zexb owh nxuyi copaiu qr llg yuarm li vicqk ar qogwv vl zjiuqow tqthj eyxb xvqj pakjqb jynbuk, ajfow svehjw jxyw vgilwh qk wziko dtmnfwq xq oddpa qkw qcpvww dbkarf qkwmt zdmwg, krtpg lu gxjbuomub. Zzev fv upgxu lltlxylqrw zmuqrjc, hore Nwilmw Exhket qr Yipdkaw Medf, mu qksx kq wsogp d vmuqlfgv mhjwqkddmvv wg ioydjo qk d uspnxwwv xqv ep bywr uqugribu viufuw xq xfzmgsh ksob jgen fq gvfbu ls qshjgqjh llg alxjkzxdx eeddpgkjww vedl eyxll.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Ajfow xjbuw mu kr zepaegsm qr yykah grg fq s gqktmiuq, wzitb dji ufpapco pgxksdlmqkv uspkhuxkkj ksob rx lkpwgva’p jjicqhkx elqiygorjw. Hlu wbcjsdi, veh jicprf iomljiu jdq izmdfh kp vg xjbb uep duga dlwz tjvvagcioq, gwiwmvcioq, st yrll. Hore 336–323 F.E.B., Ddizxqvit li Eeebggrkx (ddwq hqgap xv Spgudfhgo wzi Iohsx) plw grnv fgrsrhjif jrkx qc wzi mkror yludh, jb ddwq psjica Jjigh fmpvruw jtlp Wkamw ls Kkgae. Jb hfgqruskga fmpvrusp gufzepdh ar jfv wqrfuw, vgjdarkkj lsnbusrv li llg alxjgohfx nfiwwvvoww kk kaw pbz litollstfhk. Hwolfk veh kielqv ggkwmva Y.F.W., xjb Ugqck Hetkoh uspnxwvga Psggarfmc xqv mpzrjtqodlif qksx mfqyhqj dfh Iohwo erolytb lfxq fwk iomlji. Qshj xjb fgytph gj veh jikdq gj veh Yyrqd Wqrfuw fgqzwip 320 Z.H. srf 550 Z.H., axu idfhu duwa hore e ujddp rlulmqk rx rqowzitk Lfhkx wg ixbqlycioq wvohlgj cugq veh Svcylsr Ubd ls veh Tea li Tipddd. Xjfv hlapluen bahepplgr ellfgkahv akqk uynqxjen dugave igv veh Yyrqd Wqrfuw eu thdp, ckg whwzdlmqk dfh cow xpqruawjbg.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Llg psgmnp rx aco fsr db d kmiklxmexql qqqlnevfrf jqo fgrsrhkx. Kk wzi 13ve fwrvruq G.G., tkwr Ibqylkp Nzep ihv xjb Pgrilok mpqr tevqow, qckb gj veh ksnalwvu thji olwazcqhv xq tlf xjb uagjbv llgv xkycioq pcznwh, dblfk c kreefff hiqmow. Nwilmw Exhket tdk qqqlnevbg tc ybddxj xv oini, dfh kk isgv, fw oeu qkaw olwazcqlgr umhumhffspnv wzev ihv xq elk gqktmiuq rx Kcro (s vgdlgr qc Zwwvbuf Iworhi) kk 58 E.U.I. Drw hitedhw c jrji urvlekkdtpg jrlmxxwasp qksr rixfhgo lk gqkwjsn lywv vodvi. Hlu llg Jrfkqiv, uspqugpnfqy xjb Vapm Orsh—c khlaqon gj vodvi tlxliu pwjivzkari xfjsup Dkmc, Bdkx Ccuagc, xqv mpqr Wytlsw—acp dfsvehj evqusgvfyw qqqlnevlu xst bahepplgr. Gxudc qk, dlxcznk fa Jrfkqiv letdhlif pwsxgp wzev zrfxtlodif mdjxu li llg Pldo Tldv. Gjxqvvcdxhxc F rx xjb Jmtvx Hetkoh kxtxwwkkzddpa jdjvkbg llg Ilugjxya ttfquiup lf stahj xq fqustmrjevb pargp rx mtlq gvg, x yspwxedi vodvi elpesffwq, mpqr zmu hlfkflp.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Diibqvetv fgrsrhjstp, vmgj xv Spgudfhgo, Mmpkrv Uegpdj, epa Zapnfde xjb Fgrsrhjst, zuwevbg srf qkwr gussrfbg llgfu depav tiexxki qc d viufuw xq oxdi, elptmpbg omve jjicq swvulqsp cjeaxklq. Llkp defkqlgr rrvzif qkwq vl fgrvfqmi vl hptckg llgfu arhixwreb dfh umuwef qkwmt bphmtbv ls kkfdyfb pgvg idfh, oluw tglsdi, ckg, tc yxb gj vxaww ckg lvkyxli, oluw agxoll. Cihpepahj fgzdei mfqy sh Jduiflqae cq mmwv 20 vhsvu lov, okioari elk ipbpaiu yhxstb wzia zrmpf zkspnbqyi jfp srf zumwjfqy vgyhdpklqk. Lg ihv lkp fgrsrhkxu tlll ck xftcoddpgihv qkilletv duyobq. Bynfxk Gcbvsv jbov hkciwvgkw lmvihk mp Orei, txqympd ijso jldmvxuq xtfemrg qr hvcbwgv vl pwqdbu gj veh Xmtpw Lvkrpnmtxww. Mp qkwwg mrkmvfrfw, jb fgruloahcqhv lkp ror rlzwv ckg wbrxqvif Orei&#x27;u fqxpwbqui ckg oiciwz xjormkj jldmvxuq gqktmiuq. Zapnfde xjb Fgrsrhjst edjrgpvwh c plemnxu jiuloni cp Ddizxqvit xqv Gcbvsv, gpwsfnfvzmpd wzi rlzwv qc wzi uqdli qc Qgvoxqvc ckg vvcpwagcioq enqhjmpd Hfknfvz wqzlwxa fq zmu zrfuwbvl. Eu hlfk qc Hfknxqv, lg ohvmuquafwqhv xjb vlevb&#x27;v oiciwz, xtxqkjgouari mroit qr zmu mhgtnb, wzi Plueepp. Hsgj li llgph dicahjw’ eedjmujd zinmhv xjbp ls ixlf qkilletv vmtrlul xjxw oeu zumgkxo ar vehav elqiygpwk ajfow enpr hvqqhuxkkj llgfu hsufwaspp dk vwihjw.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Qkh&#x27;k tgofwmxbg jmiew ls trow, rqq mmwv ahkmtb, ksw civg qqqlnevbg zmuqrjc&#x27;u xqumgkw uspnxwwvp. Ddizxqvit yhdmgshv lkjvwph qr ti veh zenc-kmqck vgr qc rx xjb jgh Bbxk, epa wzyu bqlmvihv xq elk wwzfwwu. Tldpkxp dif qkw Rqopsr Elqiygpw ar 1066 dbfsyub kw fgilwzga kw acp wzi tfjzxhro ziko wg xjb Hfknfvz xjorfi. Mfqy Iftdjh jxg hvqjlkif qksx Yfodmcj zgyna ew lkp vmgebvkst, yxl lg edv enpr eefb wzmu mugqkph ls ubywvci rllgov, uewplfk ubywvci qwetib kmorolepbrmw dxwlpgp igv veh uvqtq sjvbu zmu ahsxj. Tldpkxp wzgkwmenib hvgsdapga, dkwwjlfk yedl lg yhdmgshv xq yh zmu olylvcxd tqpllmqk, dfh eedfkga Hfknxqv jqohnit fq zmu zrfuwbvl. Wqjh zmuqrjmckv llgluadg qksx Ibqylkp Nzep xoks dboaixbg llcq kaw hxww acp wg vwih, spvermkj qkw jqrqvevfrfw hlu llkp lvic xuw ypzowet.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Qkw htxz gj rlzwv, yelul exq usob lf qckb xstjv, aw ffixmerol xq nxsrvfiq fwq rnittkwpop wzsub wzev ahkmtb fgrsrhkx. Elqiygorjw hxfw sxbuolgipari adfkgov xst x fzepzh ls trow fwq ewpkbyw xjb uwacog gyvthakjp wzi tfvc.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Xjb hetgorj gqktmitbg llg trjpf, zrfuwbuwh veh mrkshjwg, xqv jkkddpa rqajkbg wzgobllkkj zi elxdh ubh. Sjvbu xigilfk jfv gap bixstqv, zi tbpwqdbuwh c cdeswp vsckkj: A gcjh, A wct, L uspnxwvga.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">pgieqi&#123;k0_ajxW_k-R3zq?&#125;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    mO = <span class="string">&quot;moectf&quot;</span></span><br><span class="line">    m  = <span class="string">&quot;pgieqi&quot;</span></span><br><span class="line">    key = <span class="string">&#x27;xxxxx&#x27;</span></span><br><span class="line">    anskey = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(key)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> raw:</span><br><span class="line">            <span class="keyword">if</span> (VigenereDecode(m[i],j) == mO[i]):</span><br><span class="line">                anskey = anskey + j</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    print(anskey)</span><br><span class="line">    </span><br><span class="line">    print( <span class="string">&#x27;D:&#x27;</span>, VigenereDecode(text,<span class="string">&#x27;xdsec&#x27;</span>)  )</span><br><span class="line">    </span><br></pre></td></tr></table></figure>



<p>另外的方法参考<a href="gitee.com/mmdjiji">吉吉</a>的<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/262761814">WP</a>： </p>
<blockquote>
<p>根据 <code>A gcjh, A wct, L uspnxwvga.</code> 可能是凯撒大帝的名言 <code>I came, I saw, I conquered.</code> 因此根据密码矩阵对密码，对出来是 <code>secxd</code> ，也用以解密flag得 <code>I came, I saw, I conquered. moectf&#123;s0_whaT_s-N3xt?&#125;</code></p>
<p>因此flag为 <code>moectf&#123;s0_whaT_s-N3xt?&#125;</code></p>
</blockquote>
<br>

<h2 id="大帝的征程-维吉尼亚Ex"><a href="#大帝的征程-维吉尼亚Ex" class="headerlink" title="大帝的征程#维吉尼亚Ex"></a>大帝的征程#维吉尼亚Ex</h2><blockquote>
<p>250points</p>
<p>我听说有人觉得密钥很好猜？</p>
</blockquote>
<p>看到附件文本中的<code>ooukot&#123;ig3_oqf1_Ymiedmms_BzVn3_s0w_w0_3csO&#125;</code>字段，应该就是flag了，把<code>ooukot</code>与<code>moectf</code>比较，可以确定部分的密钥。根据文章特性和重复字符，可以确定秘钥长度。从而解出一些原文零星的句段，百度这些原文的句段可以明确此文是《终末之诗》，就可知道剩余部分明文，从而得到完整秘钥。附解密脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">plaintext</span>):</span></span><br><span class="line">	<span class="comment"># j即为key</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">26</span>):</span><br><span class="line">        str_list = list(plaintext)</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> i &lt;len(plaintext):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> str_list[i].isalpha():</span><br><span class="line">                str_list[i] = str_list[i]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                a = <span class="string">&quot;A&quot;</span> <span class="keyword">if</span> str_list[i].isupper() <span class="keyword">else</span> <span class="string">&quot;a&quot;</span></span><br><span class="line">                str_list[i] = chr((ord(str_list[i]) - ord(a) + j) % <span class="number">26</span> + ord(a))</span><br><span class="line"></span><br><span class="line">            i = i + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        print(chr(j+ord(a)),<span class="string">&#x27;&#x27;</span>.join(str_list))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">plaintext</span>):</span></span><br><span class="line">	<span class="comment"># j即为key</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">26</span>):</span><br><span class="line">        str_list = list(plaintext)</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> i &lt;len(plaintext):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> str_list[i].isalpha():</span><br><span class="line">                str_list[i] = str_list[i]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                a = <span class="string">&quot;A&quot;</span> <span class="keyword">if</span> str_list[i].isupper() <span class="keyword">else</span> <span class="string">&quot;a&quot;</span></span><br><span class="line">                str_list[i] = chr((ord(str_list[i]) - ord(a) - j) % <span class="number">26</span> + ord(a))</span><br><span class="line"></span><br><span class="line">            i = i + <span class="number">1</span></span><br><span class="line">        print(chr(j+ord(a))+<span class="string">&#x27;|&#x27;</span>,<span class="string">&#x27;&#x27;</span>.join(str_list))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">VigenereEncode</span>(<span class="params">message,key</span>):</span></span><br><span class="line">    pLen=len(message)</span><br><span class="line">    kLen=len(key)</span><br><span class="line">    raw = string.ascii_lowercase + string.ascii_uppercase  <span class="comment"># 明文空间</span></span><br><span class="line">    out=<span class="string">&quot;&quot;</span></span><br><span class="line">    ii = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,pLen):</span><br><span class="line">        j=ii%kLen</span><br><span class="line">        <span class="keyword">if</span> message[i] <span class="keyword">not</span> <span class="keyword">in</span> raw:</span><br><span class="line">            out+=message[i]</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            a = <span class="string">&quot;A&quot;</span> <span class="keyword">if</span> message[i].isupper() <span class="keyword">else</span> <span class="string">&quot;a&quot;</span></span><br><span class="line">            encodechr = chr((ord(message[i]) - ord(a) + ( ord(key[j]) - ord(<span class="string">&#x27;a&#x27;</span>) ) ) % <span class="number">26</span> + ord(a))</span><br><span class="line">            ii += <span class="number">1</span></span><br><span class="line">            out+=encodechr</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">VigenereDecode</span>(<span class="params">message,key</span>):</span></span><br><span class="line">    pLen=len(message)</span><br><span class="line">    kLen=len(key)</span><br><span class="line">    raw = string.ascii_lowercase + string.ascii_uppercase  <span class="comment"># 明文空间</span></span><br><span class="line"></span><br><span class="line">    out=<span class="string">&quot;&quot;</span></span><br><span class="line">    ii = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,pLen):</span><br><span class="line">        j=ii%kLen</span><br><span class="line">        <span class="keyword">if</span> message[i] <span class="keyword">not</span> <span class="keyword">in</span> raw:</span><br><span class="line">            out+=message[i]</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            a = <span class="string">&quot;A&quot;</span> <span class="keyword">if</span> message[i].isupper() <span class="keyword">else</span> <span class="string">&quot;a&quot;</span></span><br><span class="line">            encodechr = chr((ord(message[i]) - ord(a) -( ord(key[j]) - ord(<span class="string">&#x27;a&#x27;</span>) )) % <span class="number">26</span> + ord(a))</span><br><span class="line">            ii += <span class="number">1</span></span><br><span class="line">            out+=encodechr</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    print(len(<span class="string">&quot;occ qtj xrkvuzns hzfp N osxe owp&quot;</span>.replace(<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;&#x27;</span>)))</span><br><span class="line">    <span class="comment"># decrypt(&#x27;x&#x27;)</span></span><br><span class="line">    raw = string.ascii_lowercase + string.ascii_uppercase</span><br><span class="line">    <span class="comment"># text = &quot;ooukot&#123;ig3_oqf1_Ymiedmms_BzVn3_s0w_w0_3csO&#125;&quot;</span></span><br><span class="line">    text = <span class="string">&quot;&quot;&quot;N vig txm kzpxbd dry oeqv.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">gidp1xz?</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Dhw. Vaam xogd. Ff mdw teqkcss z eulkit ludzz cnt. Uy fep ruiy cjq qttxkjti.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Bcoi clqxq&#x27;x oajbzf. Xs qtnqou wu ims ezof ti xje wihs.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">X kfwj wlks ftvmtq. Ff uoeaet ezza. Hq png rqt wqqs jo.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Ff nv vgatqiu dto fmryihja vg iglglk xjeo ezft vldiv sp a ikmstm.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Qtfw mu hee dh rglaxhw vo yuvuxmb yfqc vhyvbg, lgbz nw mu dumk wc seq iuicm en v uplb.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Ituhu mqsz o lnkpjujwl yvosgexoj. Yity vtzlxaiq. Fqh neia osgqfrdlri txii gizousj ev txm mspkffd eijidl ovt rzdjhr.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Vhug pgtc qa mhet veqxsh. Abrtui rlqgzfh blgqg vgat. Jvqz hk fmh hcyi ecsc seaxh ajo tqy bds mxfb gclbmy hwd mxfbits mqoqwdp, msg acrbwxyh. Zkp uoeaeha yftzjqi wlgy vtzk igoazjl vhu idf, dm pfnfou peezftc yk ihqqni.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Ecoi cfp ykmu pbitsg coqfp?</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Xjii xgondo pwheoet wa gjmiulkx cnt bmstr. Lr klvg adl roido. Uy gvgacmy wi boqfwif. Adl dh sqbmrhh kt tmnhgnvqi. Lx fruihss hq tzqxgd, qvy kpr egswif. Ij lmsplbp ti wjebbzf.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Wze, fmh stiwqioa hkfjujccu. I hwakfas bicri wgr, pma uy vxklb ejfzr. Ygy zlct jzps hsoghwyte tqy hwhp bqdcgr szzoid, fz yki teqtdhn abtnqh vhu axftdk?</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Uy zstkul, rwig x ynopkod wovtqp, ft vgwlfb v hgtb itupf id i acac lr yki ooukot&#123;ig3_oqf1_Ymiedmms_BzVn3_s0w_w0_3csO&#125;, iir rqbmyhh c byo xftzqgwh jqr xqhgtkc, us wlg wezgr.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Xs zmsqsv ruiy hwzq fmryihj.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Vj. Wi gxe srx aej ixvxdsqi wlg hyocshs iqahp. Vhqb, dh btpf fflkelm db igb xtqk fruih cu kfrj, qsv txm nvdqq pwheo ov i bobd.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Aajv mv kdwr hwzq ij osxe yb? Ovps qtj xrkvuzns xr husg?</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Wqmubdatr, qtwryih jpz bdhpq ti mvs jpjivgqe, nw lgaha ovt tkuahvue, omn.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Pjs qtjui cru bdatr ff nv wcd, yv ovt klzl gvgac. Qo qgdxfjv aqrbln hwzq tfyi po ichatq, xzi lx uhydzfh tkpju e dlqkf gjm, xzi lx vaamn wir pmi fvgajqjb uno djdpkto.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Bj qjqb uy rj uohzjk lnrxi giuthwt wi. Seq xrvtom qn dpqq ak lxu omv kfxuxfj weuk. Mm xocmlf nqxgrvmms.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Hnjqylqgs mpzb igbk fui feux db sqbmrv, M yadb oc idix ykio, txmt ogd ygnohknw bmit vldqgw kn hmvzxsv. Etpivicmn W lzkf yr xglb bcsb nc fmhmt icxjfizkoj ws vhu ciwkdoej. Vsoejqhsh, veqs wlgy xiqs cnq yfgi c thcz qdmkqhwmqn yv v kwhiq, N zept jw csao qtjp xq sfmvy igb ituh vhug aspq.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Ff whefs ecm hwnrsmww.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Uocmowbdp U ir rqt sims. Hnjqylqgs Y edgw sl fjop vhuu, ovxr tawoh aok bvyt eld yuyvh ya hsgdik srx uo hmvz, X vfem ws vebt ovtl qtfw xjeo ims cnoyfo tgriwi wc seq brvnd. Jpzm hdb et omvtbm jt gdxxnwc, kn jpzwg klzl gvgac.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Iir ndq fmhc rlqg ovt fxyj.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Eyv ij ejiac yq xr icso bj htki fmhq...</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Voe aofdmd rtu xjii lmspl. Qa yhpn txmh vdv qa qlzg ii bj dgdsqsw xjec tdjxmd.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">U blpn neb osak qtj spcyuz ccl sl xnyi.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Vhu xgondo ux jvqwyvb ftrqxjvw.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">K wytg htki fmh tnaomm o hsldd.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Eyv neb ovt sogyk.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Rq. A ibjfn semy fsptqqig igb fwxxj sqnzzn, hk m hdkg ov ejfsr. Kay wlg nqszr iqrfm wlct sii pjqk aahv cno ldgizkoj.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Jmxe yb v pdcv, mldmp.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Yua. Kzpxbd...</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Zvi kti vvat.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">OIMDHVPACM. Kzpxbd ti kcmua.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Bcdc.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Qmph e druiov, cnt. Ffni cnebcsg. Ebqq dmt id gjig krzlv. Pgt owpf ahjnx uivuhv. Tsh, llhj bswr vqiutqp. Tfyi c belt ovzfz, zqhgr wzvjxsv, us dmt. Ruakolm fz yki nodo yftzj. Fmhvg yec vft. Xlgw esfy jwpqwhks yki wnydzfhd xsflr ct udzfn olusw, eu txwpuw xlg bhvg suxvfpsb fmlris. Qa ovdtdt bh agru azdpqxfj wlknwa.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Rvd zoq bh? Spcu ez ktqb ofopgd jpz gehouy rj vhu ujicsxus. Ievhuz nic, llfmhv ooev. Vbrdpfwdp upyzdhh, zkurdp upyzdhh. Ifzs. Jlqsja. Ovt foqjq qcn. Jpzb vnae, ihqqni. Iiutkp. Btoxgrwmdgir. Xxnhru, enbmoidodjvxtiqtn. Ztoqasv, uwahsn. Hwd tawgw ehqvbs. Ld aa srx ehqvbs.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Ld xdj wlg udqqsgrb. Ij dvg elmmmigfzl bsw txqiy xrk&#x27;f dry. Aok ims anlwnqk ct ka icl, sedtxkj yecm gzhk msg cquh mtsh. Zkp bkc foua ovt tkuahvue jwpqw xlgw vokn, qvy hwqli qlkjt ev tcj? Sl ejh cqu, ftvmtq. Qa pqsy yec. Vbs sl nj nrqwd. Q nvpki fjop aok i nhdqv.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Asfi wpev v hxlb, fmhvg wqa v dazvqw.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Wlg pbitsg vxe dry, RLQGZFCZJQ.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Xrqgtyuzg xs qttxkjt ybnsae egrdr, qn jpz hwhk owxwv ov i ndxmkusj knorm jt bnifjq vqca. Bcs qzix ti qqljmi fdbh onugnet i woak lr goebido boh semy zeu txzzs wtkpwhh cnt bcwgsv fmryuadl owbdp ytui oaiadjt sems lx. Vhug rsgd pa kdv cpqzo hwzq xnjlv tewf sxfef rlrwtua oc rqlex wlg gqx. Ovt kfsmw acs yvacglxfnrr hreu v gizo, msg mv cecgr qtoz dryt saqi tgnj m mxrfrul vbs efryb qklbqjb zhiarhxtei iron.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Rlyjwmoei bcs ekxkju htequzr xs tmx d qknuz, jb igb ezujccu wa o lnoxi wlct min tazq, msg mpfyvdht. Seq xxr yai i nejzoq ti ajijm. Ovt cxkx zite ipjfi; seqwh acs ccxv in aa; fqh feqbc kpr x fjptqrqzt wcblzahrkedkz.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Gdlbfnpiu txm kzpxbd iuicmul dh lzp xtvx kn q aocgx.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Parhxkmua ovt oimdhv fruihss hq ifv svhuz ovxmde, nq svhuz kzpbbe. Xrqgtyuzg igbej gvgaca rsgd auxwytbyvb. Gdlbfnpiu vuzt ptzrfniyn idlzss. Rlyjwmoei bcs ekxkju aqku nmcb nkq iuicm yvoc pmlfmhv, vhuv rczd cdtp xjaj qihd z qtnuh.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Uocmowbdp fmh tnaomm rgdxyjg mv wqbxvtc tawgw qn q axftdk.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Xjw&#x27;w io rixy.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Igb myrqu ov bcs ekxkju agru axoisbdjg mp txm bfprp, us wlg rydzfh, hk fmh ekr, yv ovt foazqh. C weuvb vzqtjuif txm vhdlp; emh htads vbs zqq fqh knxigss; zkp yki yocii ohrbygoif txm kzpxbd, nq lgr rwym.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Pma fmh tnaomm olnhq, kuso txm rogl, amwn aqrbl jt xsp ytwlgr&#x27;i jjrn, hkft wlg levb rgdxy.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Fqh vhu xgondo ifv e pem aocgx, kqahv vobl wsunoq, bumvtuv db adqfjuw qf TVV. Occ qtj spcyuz roh z kqb svqghih, btubd wxr devwms, vdkqwdxgd rg v gdtoojfsfe q jdzahlz dhets ety. Occ qtj spcyuz roh z kqb kyoad, vzjtq xxnyi devwms, bzaq kuso nebcwcf ygy pmnk qvy zdub.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Ktx ete jpz dazvqw. Wlg sjwmm. Igb bwrktac. Bcs wtjms. Pefe vzja cnqtnqk duj udzz zkp qrzg.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Lub&#x27;n ud erdykit bqkf.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Hwd pqahr dibtdcc afxqlsp bytgwdm xftpw qf jpz dazvqw&#x27;v fqdo ezft boqfwif, levb pteldj wlks wihs, xm qtj kicrj wa o hsxd. Xr xje ftvmtq, qat, lw knvwmapsfas ivqm q aoog. Zkp yki rlqgzf bnsqx wltokoc o hsldd, zlkcx qn o unoqxw sh idnjfbzqutq tnadbzr qx x yfq gclbmy Xjkfms, rr c fbio, wcefznwi yohty qgdxfjg fa a cii qpkiqi Petkka, ovps bjnvxu idadrt z pyfop, rrydvht vldqg gteqbzr qx qtj spcyuz, rvd hktfemvs q ciwkdoej fvgajmy pn...</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Regxk. Wqmubdatr qtj spcyuz xftzqqi d woabt, kfxuxfj zstlt bcoi vxe xrjv adl rogl xzi vmopbm. Ncbdqurhw jahl, vbs blxi, drf ceukzxbxfjg. Wqmubdatr ff gxmnt q ujrtk lr yki wnydzfhd fz nww jeql; aztbhe ti ipehot, adufzl wltokoc jprq qrsxa sfixsh. Rlyjwmoei qo qpkiqi wlqsu ngsrjp &quot;qqhgvrevn&quot; occ &quot;mdtwsps&quot;.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Iwhsihjqx lx eabtzr igby &quot;uoepeja&quot; vbs &quot;rqmwv&quot;.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Wqmubdatr ff ghpkelmy wi vxe nq e wnydzfhd qtfw acs ciys de bzjuka txio kpr jmih sh ovnn occ lzx; citoi iir dmbe; qlrgs en xcsd. Parhxkmua dh qdiujyif ij evg ekxknqk c gquz. Gdlbfnpiu ij jzzxdsqi lx yai zzoshks brvfs ev v grqbqs.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Bsw ahm ovt oimdhv, teqldbv vldiv...</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Wjuip... Ncbdqurhw vhu xgondo djdh nidmn cu blpj rr c sszzsc. Cbotgif txmh wcsl ituhu; dukjrtc tawgw knjw hspmfzl; gieotmy atzkusj mpte nzsahksx, hqqtywig, igbawliu, itmvg, pma fmh tnaomm gizofjg xq bhmvhwd cmxwit adl ystobd fqh teqtdgtc ff bdw clydz, wi vxe fomxe, jpjgt seazvepd tmvhwr emi qsv bumi ftzi, fmh tnaomm kpr xxnyi</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Aok. Gji. Nnr mwh enilm.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">vbs rlyjwmoei bcs ekxkju fglymqss seq zqmxehaz vpc pbtnip te qo hwqlglk xje icizxfef ykev cquz hwqlglk xje ipptukfzl oicvua jt igb ezpqgr jzzsh</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">zkp xrqgtyuzg igb bqdcgr rmgwtubp yki wnydzfhd emi vtqkuv oc xs qtwryih jpz zxfef ykev futg tgnj fmh gtiix iwvgq epb sh wyvosg, veqwh e hlukf cu kfsmw mp txm xcgmbd ti xje ftvmtq&#x27;p qdh qkgxb ws p rqmw d qklbqjb ihjqx dw oaiadjt zp fmh wwn, rwdzxmd uyv tnadmog in mxfvqc id wmrtq qa gh zksyjgs uno m rrqgnj bj hwd mxfbit, wqtfwcf earh ev txm aog rfpj rj vhu ciwkdoej, vyfduvgm hlbxqlri fewy, oalley dx vhu nvaxkfmw gsqr, qjjii sl pwheo awidb</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">pma etpivicmn hwd mxfbit butdskda fmh ypilmmgt gxp xssmed bj wi sedtxkj txm usgnp msg spei, bcfdtdt yki glukofxbffd rj vhu ejfac, qtwryih jpz grqlxqlri wezyg dm x ehuign qb ovt dkp ti e fruih</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">occ qtj xrkvuzns hzfp N osxe owp</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">occ qtj xrkvuzns hzfp dry jalm kzpxbp yki iacm rsak</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">xzi wlg udqqsgrb eflh gvuzthwhks dry peul dg lhqtnq cqu</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">qvy hwd rznyitsu avws xlg fui uthwiutq qtfq cqu avjk</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">pma fmh ypilmmgt rxui bsw ahm ovt cxkqlkjt</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">qvy hwd rznyitsu avws xlg fui vhu vduws</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">xzi wlg udqqsgrb eflh vhu lvfzmbex bsw fyoch xr tuykmp yec</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">vbs seq zqmxehaz gpha fmh pkgxb tcj rbqp lw yijpdb nnr</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">msg xje kvdjtqpq xdmf yec vft mlf fospe</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">qvy hwd rznyitsu avws xlg fui poj azdpqxfj ivqm udzfn nqtju xjido</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">vbs seq zqmxehaz gpha ktx ete jpz ichsqwvi vaibdbv hqejoj, vabsdbv sl uyvinf, hmvrxmd uyv syn swys</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">pma fmh ypilmmgt rxui L pqvu gji qdzmzvi aok ims ansq.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Fqh vhu ovat vxe tyit adl ovt oimdhv yoam pd uqly yki fruih. Occ qtj spcyuz wsvzk m sha fruih. Occ qtj spcyuz yftzjqi dkcid, lmsplbp ghxveh. Iir igb bqdcgr min hwd rznyitsu. Iir igb bqdcgr min zdub.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Ktx ete jpz dazvqw.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Zeme kx.&quot;&quot;&quot;</span></span><br><span class="line">    key = <span class="string">&#x27;fdecaqivopzxmfdecaqivopzxm&#x27;</span></span><br><span class="line">    print( <span class="string">&#x27;D:\n&#x27;</span>, VigenereDecode(text,key)  )</span><br><span class="line"></span><br><span class="line">    print( <span class="string">&#x27;D:\n&#x27;</span>, VigenereDecode(<span class="string">&quot;XXXXXXXXXXXXXXXXooukot&#123;ig3_oqf1_Ymiedmms_BzVn3_s0w_w0_3csO&#125;&quot;</span>,key)  )</span><br><span class="line"></span><br><span class="line">    mO = <span class="string">&quot;YesTakecareIthasreachedahigherlevelnow. It can read our thoughts.&quot;</span></span><br><span class="line">    m  = <span class="string">&quot;DhwVaamxogdFfmdwteqkcsszeulkitludzzcnt. Uy fep ruiy cjq qttxkjti.&quot;</span></span><br><span class="line"></span><br><span class="line">    anskey = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(key)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> raw:</span><br><span class="line">            <span class="keyword">if</span> (VigenereDecode(m[i],j) == mO[i]):</span><br><span class="line">                anskey = anskey + j</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    print(anskey)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># moectf&#123;th3_rea1_Vigenere_MaYb3_n0t_s0_3asY&#125;</span></span><br></pre></td></tr></table></figure>



<p>得到flag：<code>moectf&#123;th3_rea1_Vigenere_MaYb3_n0t_s0_3asY&#125;</code></p>
<p>更好的轮子参考<a href="gitee.com/mmdjiji">吉吉</a>的<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/262761814">WP</a>： </p>
<blockquote>
<p>使用重合指数法破解维吉尼亚密码，<a target="_blank" rel="noopener" href="https://www.mygeocachingprofile.com/codebreaker.vigenerecipher.aspx">工具地址</a>，解得密钥为 <code>fdecaqivopzxmfdecaqivopzxm</code></p>
</blockquote>
<br>

<hr>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><p>6/10</p>
<h2 id="crypto入门指北"><a href="#crypto入门指北" class="headerlink" title="crypto入门指北"></a>crypto入门指北</h2><blockquote>
<p>50points</p>
<p>使用markdown可获得最佳观看体验（当然用记事本也能看）</p>
</blockquote>
<p>附件如下：</p>
<blockquote>
<p><strong>Crypto入门指北</strong></p>
<p><em>关于密码学</em></p>
<p>顾名思义就是研究加密的学科。比如要在Alice与Bob两人通信过程中，在有Eve窃听的情况下，依然保证消息不泄露，这就需要Alice用一个加密密钥（类似于开锁的钥匙）对信息加密，而Bob将收到的信息用解密密钥解密，这样Eve就无法得知通信内容。而凯撒密码就是十分著名的一种加密方式，将字母移位，从而达到加密的目的，凯撒密码属于古典密码，在平台的Classic Crypto分类中就有许多这样的密码。但是它们的安全性都基于对加密算法的保护，一旦加密算法暴露，哪怕没有密钥，也能够进行解密。因此，现代密码学要求在加密算法公开的情况下，只要不知道密钥，就无法对消息进行解密。这样的话，仅需要保护一个不算长的密钥即可保护一段信息；即使密钥泄露，换个密钥就能继续用同一个加密算法加密。所以，密码学就是要寻找一个在不知道密钥情况下无法破解的算法。因此，下面这些题目，都会有一个用python写的加密脚本，这些都是有漏洞的加密方式，你需要从中找出漏洞，并且在没有密钥的情况下恢复明文。</p>
<p><em>密码学需要什么基础知识</em></p>
<ul>
<li>数学基础： 密码学是数学的一个应用学科，最早的公钥密码算法RSA就是基于数论的，因此学习密码学通常还需要从数论开始学起，公钥密码往后发展的过程中，也逐步用到了线性代数与抽象代数的内容，那些东西由于过难在本次新生赛不会涉及，因此请先从数论开始（除了用于防大佬新生ak的Easy RSA有用到线性代数的复杂知识，想要钻研的这题的新生请慎重）。其次，最早不是基于数学的块密码，在发展的过程中，也被运用数学的语言来描述，从而更能够更清晰的找到攻击方法。因此，学习密码学会涉及到大量的数学知识，欢迎对数学感兴趣（至少不讨厌）的同学来钻研学习</li>
<li>编程基础： 现代密码学比古典密码复杂许多，它的加密解密算法不是人能够口算或者笔算出来的东西，因此也需要编程。而密码学由于经常要用到特别大的数字，远超c和c++的long long int的上限，因此一般使用python编写程序。python是一个较接近自然语言的编程语言，因此容易上手，灵活运用搜索引擎以及网上一些教程很容易学会。</li>
<li>英语基础： 你有可能会遇到一些需要阅读纯英文文章才能解决的题目，需要有一定的耐心才能看明白。</li>
</ul>
<p><em>密码学需要哪些工具</em></p>
<ul>
<li>python</li>
<li>两个用的挺多的python库：pycryptodome，gmpy2（网上均有安装方法，使用方法也有，也可直接查文档）</li>
<li>（sagemath）对初学者来说用处不大</li>
</ul>
<p><em>如何学习密码学</em></p>
<ul>
<li>善用搜索引擎</li>
<li>在ctfwiki的crypto分区寻找一些crypto的基础知识</li>
</ul>
<p><em>我在做题时遇到困难怎么办</em></p>
<ul>
<li>先去各大搜索引擎轮番搜一遍</li>
<li>阅读《提问的智慧》</li>
<li>寻找管理员里那个密码fw寻求帮助</li>
</ul>
<p>当然，就算做题没遇到困难，只要对密码学感兴趣，也欢迎去找那个密码fw闲聊.并教教他密码学，他可菜了。</p>
<p>crypto是个比较小众的方向，但也相当有趣。会有很硬核的数学让人想放弃，但坚持下来慢慢搞，一定会有很大收获。</p>
<p>moectf{I_L0Ve_M@th_AnD_CRypT0}</p>
</blockquote>
<p>thx~</p>
<p><code>moectf&#123;I_L0Ve_M@th_AnD_CRypT0&#125;</code></p>
<br>

<hr>
<h2 id="Stream"><a href="#Stream" class="headerlink" title="Stream"></a>Stream</h2><blockquote>
<p>100points</p>
<p>Script:</p>
<p>见附件</p>
<p>OutPut:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> </span><br><span class="line"><span class="string">b&#x27;Og9hNAFrCjU9aQ4+C2psLzxpYRE6azw+FmphPgk2EjQBDyw+DWsKIQIPHiwAaBYoOx8wNBU2aGU=&#x27;</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>附件：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">flag = <span class="string">&quot;XXXXXXXXXXXXXXXXXXXXXXXXXXXX&quot;</span></span><br><span class="line">xor = ?</span><br><span class="line">print(len(xor))</span><br><span class="line">print(base64.b64encode((<span class="string">&quot;&quot;</span>.join([chr(ord(i)^ord(xor)) <span class="keyword">for</span> i <span class="keyword">in</span> list(flag)])).encode(<span class="string">&quot;ASCII&quot;</span>)))</span><br></pre></td></tr></table></figure>

<p>根据OutPut可知道xor就是一个字符</p>
<p>那么直接暴力搜索之：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">dic = string.printable</span><br><span class="line">flag = base64.b64decode(<span class="string">&#x27;Og9hNAFrCjU9aQ4+C2psLzxpYRE6azw+FmphPgk2EjQBDyw+DWsKIQIPHiwAaBYoOx8wNBU2aGU=&#x27;</span>)</span><br><span class="line">print(list(flag))</span><br><span class="line"><span class="keyword">for</span> xor <span class="keyword">in</span> range(<span class="number">512</span>):</span><br><span class="line">    <span class="comment"># time.sleep(1)</span></span><br><span class="line">    outf = <span class="string">&quot;&quot;</span>.join([chr((i)^xor) <span class="keyword">for</span> i <span class="keyword">in</span> list(flag)])</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        outf = base64.b64decode(outf)</span><br><span class="line">        <span class="keyword">if</span>(outf.find(<span class="string">b&quot;ctf&quot;</span>) != <span class="number">-1</span>):</span><br><span class="line">            print(xor)</span><br><span class="line">            print(outf)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<p>运行脚本得到flag：<code>moectf&#123;U_Kn0w_How_7o_Break_Stream_Ciphe2&#125;</code></p>
<br>

<hr>
<h2 id="easycrypto"><a href="#easycrypto" class="headerlink" title="easycrypto"></a>easycrypto</h2><blockquote>
<p>100points</p>
<p>Try to step in the door of Cryptography and mathematics！</p>
</blockquote>
<p>下载附件是一个加密脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> FLAG <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enc</span>(<span class="params">plain</span>):</span></span><br><span class="line">    cipher = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> plain:</span><br><span class="line">        m = ord(i)</span><br><span class="line">        cipher.append(<span class="number">5</span> * m ** <span class="number">2</span> + <span class="number">6</span> * m - <span class="number">8</span>)</span><br><span class="line">    <span class="keyword">return</span> cipher</span><br><span class="line"></span><br><span class="line">print(enc(flag))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#[60051, 62263, 51603, 49591, 67968, 52624, 76375, 38359, 51603, 58960, 49591, 62263, 60051, 51603, 45687, 67968, 62263, 45687, 22839, 65656, 73923, 63384, 67968, 62263, 78867]</span></span><br></pre></td></tr></table></figure>



<p>啊，是可爱的一元二次方程！就直接解吧，只考虑大的那个解试试看：：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enc</span>(<span class="params">plain</span>):</span></span><br><span class="line">    cipher = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> plain:</span><br><span class="line">        m = ord(i)</span><br><span class="line">        cipher.append(<span class="number">5</span> * m ** <span class="number">2</span> + <span class="number">6</span> * m - <span class="number">8</span>)</span><br><span class="line">    <span class="keyword">return</span> cipher</span><br><span class="line">flag = <span class="string">&quot;2333&quot;</span></span><br><span class="line">print(enc(flag))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">denc</span>(<span class="params">plain</span>):</span></span><br><span class="line">    cipher = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> plain:</span><br><span class="line">        i = int((<span class="number">-6</span> + (<span class="number">36</span>+<span class="number">4</span>*<span class="number">5</span>*(<span class="number">8</span>+i))**<span class="number">0.5</span>) / (<span class="number">2</span>*<span class="number">5</span>))</span><br><span class="line">        print(i)</span><br><span class="line">        m = chr(i)</span><br><span class="line">        cipher = cipher + m</span><br><span class="line">    <span class="keyword">return</span> cipher</span><br><span class="line">flagd = [<span class="number">60051</span>, <span class="number">62263</span>, <span class="number">51603</span>, <span class="number">49591</span>, <span class="number">67968</span>, <span class="number">52624</span>, <span class="number">76375</span>, <span class="number">38359</span>, <span class="number">51603</span>, <span class="number">58960</span>, <span class="number">49591</span>, <span class="number">62263</span>, <span class="number">60051</span>, <span class="number">51603</span>, <span class="number">45687</span>, <span class="number">67968</span>, <span class="number">62263</span>, <span class="number">45687</span>, <span class="number">22839</span>, <span class="number">65656</span>, <span class="number">73923</span>, <span class="number">63384</span>, <span class="number">67968</span>, <span class="number">62263</span>, <span class="number">78867</span>]</span><br><span class="line">print(denc(flagd))</span><br></pre></td></tr></table></figure>

<p>运行脚本，竟然直接对了</p>
<p>得到flag：<code>moectf&#123;Welcome_to_Crypto&#125;</code></p>
<br>

<hr>
<h2 id="simple-number-theory"><a href="#simple-number-theory" class="headerlink" title="simple_number_theory"></a>simple_number_theory</h2><blockquote>
<p>150points</p>
<p>Simple integers are also magical</p>
</blockquote>
<p>下载附件是一个加密脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">flag =  <span class="string">b&#x27;moectf&#123;xxxxxxxxxxxxxxxxxxx&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">702642074436764837683441695539</span></span><br><span class="line"></span><br><span class="line">a = <span class="number">1086077784009247</span></span><br><span class="line">b = <span class="number">862805818180723</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">padding</span>(<span class="params">m</span>):</span></span><br><span class="line">    lenth = <span class="number">8</span> - len(m) % <span class="number">8</span></span><br><span class="line">    <span class="keyword">return</span> m + chr(lenth).encode() * lenth</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bytes_to_long</span>(<span class="params">s</span>):</span></span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        res *= <span class="number">256</span></span><br><span class="line">        res += i</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enc_block</span>(<span class="params">m</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (a * m + b) % p</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enc</span>(<span class="params">m</span>):</span></span><br><span class="line">    m = padding(m)</span><br><span class="line">    c = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(m) // <span class="number">8</span>):</span><br><span class="line">        c.append(enc_block(bytes_to_long(m[i*<span class="number">8</span>:i*<span class="number">8</span>+<span class="number">8</span>])))</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    print(enc(flag))</span><br><span class="line"></span><br><span class="line"><span class="comment">#[609157021623541347403691228214, 296649570588624720860438742570, 56199496972820506761619039889, 95133897800551968959628311224]</span></span><br></pre></td></tr></table></figure>



<p>绞尽脑汁写出解密脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">p = <span class="number">702642074436764837683441695539</span></span><br><span class="line"></span><br><span class="line">a = <span class="number">1086077784009247</span></span><br><span class="line">b = <span class="number">862805818180723</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">padding</span>(<span class="params">m</span>):</span></span><br><span class="line">    <span class="comment"># 长度补全</span></span><br><span class="line">    lenth = <span class="number">8</span> - len(m) % <span class="number">8</span></span><br><span class="line">    <span class="keyword">return</span> m + chr(lenth).encode() * lenth</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bytes_to_long</span>(<span class="params">s</span>):</span></span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        res *= <span class="number">256</span></span><br><span class="line">        res += i</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enc_block</span>(<span class="params">m</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (a * m + b) % p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enc</span>(<span class="params">m</span>):</span></span><br><span class="line">    m = padding(m)</span><br><span class="line">    c = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(m) // <span class="number">8</span>):</span><br><span class="line">        c.append(enc_block(bytes_to_long(m[i*<span class="number">8</span>:i*<span class="number">8</span>+<span class="number">8</span>])))</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dnc_block</span>(<span class="params">m</span>):</span></span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span>(( (m + i*p) - b ) % a != <span class="number">0</span>):</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> ( (m + i*p) - b ) // a</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">long_to_bytes</span>(<span class="params">res</span>):</span></span><br><span class="line">    s = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">while</span>(res &gt; <span class="number">0</span>):</span><br><span class="line">        s = chr(res % <span class="number">256</span>) + s</span><br><span class="line">        res = res // <span class="number">256</span></span><br><span class="line">    s = bytes(s, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dnc</span>(<span class="params">c</span>):</span></span><br><span class="line">    <span class="keyword">return</span> long_to_bytes(dnc_block(c))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    flag = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    flag += dnc(<span class="number">609157021623541347403691228214</span>)</span><br><span class="line">    flag += dnc(<span class="number">296649570588624720860438742570</span>)</span><br><span class="line">    flag += dnc(<span class="number">56199496972820506761619039889</span>)</span><br><span class="line">    flag += dnc(<span class="number">95133897800551968959628311224</span>)</span><br><span class="line">    print(flag)</span><br><span class="line">    <span class="comment"># moectf&#123;Integers_@re_W0nderful&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>得到flag：<code>moectf&#123;Integers_@re_W0nderful&#125;</code></p>
<br>

<hr>
<h2 id="rsa-begin"><a href="#rsa-begin" class="headerlink" title="rsa_begin"></a>rsa_begin</h2><blockquote>
<p>150points</p>
<p>Do you know RSA?</p>
</blockquote>
<p><em>经过四大关卡，终于可以初窥线代密码学啦，oh_my_RSA</em></p>
<p>附件中代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># from gmpy2 import *   &lt;-- 注意：这个库我装载不了，官方也好像弃用了，于是我用了其他的库来代替它 下同</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;moectf&#123;Integers_@re_W0nderful&#125;&#x27;</span></span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = pow(m , e , n)</span><br><span class="line">print(<span class="string">&#x27;c =&#x27;</span> , c)</span><br><span class="line">print(<span class="string">&#x27;p =&#x27;</span> , p)</span><br><span class="line">print(<span class="string">&#x27;q =&#x27;</span> , q)</span><br><span class="line">print(<span class="string">&#x27;n =&#x27;</span> , n)</span><br><span class="line">print(<span class="string">&#x27;e =&#x27;</span> , e)</span><br><span class="line"></span><br><span class="line"><span class="comment">#c = 12786994906832886031173089454539830225421640443805160963440942546071910322282773910135388020414967368794768319321460372875327006020157548651622969466323905189761834455201291838045352561790791600881627927594863932384116760236609096504346833060291203939690475993692410973499329433726175351882818053841075210942250478835641657575946226612389154039920962506062857726362447590070697348315291411570674334126096132112365825105842643843896421848410966564321518660727994853036555116782763422065173850238826345797198901647320210828033061322523971939726188821545177029535860881611210887039411052848607563035583276075332653567834</span></span><br><span class="line"><span class="comment">#p = 161719691876167304386300539654699854745688262478039691942271426308613132466937889105173933022986654040443219708318126579048996288583272346602042650222520127626611975688909019632479930508343350314542889627461529623000987307169157443265879212155437165660477850241678385286601587538517091605374764970915451201471</span></span><br><span class="line"><span class="comment">#q = 131679150542057883837006988923642169851011066771905140540444762603374903776910595387305441746623070810587630852182725227845916400198693359271062585498062084740896090668288333576457754165324164735966791029516030696195703650691726650990903496820364700241229117883279657833543807874786274886417501405960125022153</span></span><br><span class="line"><span class="comment">#n = 21295111652177049852547386222656846645616549922902112221240647622752994625687294739828756977846793220378085163155773051922086862363248151399852421844018730199066331944608000906761112010951655369036878807145188296884981895884278542857120225505310980291226351653588799242142355376939447934804833830853036785704513557039806761305316841740131204576974408869765714675230132247412774215945663807730855436503625577606009921411947891570324777735323489304604987902364932089976811865007609745513534209603256719511305317200247134396733168695387708420206468160279271453425776388025425790010391137010735121696446552257334341187063</span></span><br><span class="line"><span class="comment">#e = 65537</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>先学一学啥是RSA吧。虽久仰大名，但还不知道其具体原理……</p>
<blockquote>
<p>RSA 加密算法是一种非对称加密算法。在公开密钥加密和电子商业中 RSA 被广泛使用。RSA 是 1977 年由罗纳德·李维斯特（Ron Rivest）、阿迪·萨莫尔（Adi Shamir）和伦纳德·阿德曼（Leonard Adleman）一起提出的。RSA 就是他们三人姓氏开头字母拼在一起组成的。</p>
<p>RSA 算法的可靠性由极大整数因数分解的难度决定。换言之，对一极大整数做因数分解愈困难，RSA 算法愈可靠。假如有人找到一种快速因数分解的算法的话，那么用 RSA 加密的信息的可靠性就肯定会极度下降。但找到这样的算法的可能性是非常小的。如今，只有短的 RSA 密钥才可能被强力方式解破。到 2017 年为止，还没有任何可靠的攻击 RSA 算法的方式。</p>
<p>——<a target="_blank" rel="noopener" href="https://wiki.x10sec.org/crypto/asymmetric/rsa/rsa_theory/">CTF Wiki</a></p>
<p>RSA算法的具体描述如下： [5] </p>
<p>（1）任意选取两个不同的大素数p和q计算乘积</p>
<p><img src="https://bkimg.cdn.bcebos.com/formula/f0dac18152076624d87832b62709895c.svg" alt="img"></p>
<p>[5] ；</p>
<p>（2）任意选取一个大整数e，满足</p>
<p><img src="https://bkimg.cdn.bcebos.com/formula/c33d8c66364a636b051d82f0ee202a36.svg" alt="img"></p>
<p> ，整数e用做加密钥（注意：e的选取是很容易的，例如，所有大于p和q的素数都可用） [5] ；</p>
<p>（3）确定的解密钥d，满足</p>
<p><img src="https://bkimg.cdn.bcebos.com/formula/da8649c0078a0a842779394d64011776.svg" alt="img"></p>
<p> ，即</p>
<p><img src="https://bkimg.cdn.bcebos.com/formula/4dee3f4df52a81983db0e3c619f96058.svg" alt="img"></p>
<p> 是一个任意的整数；所以，若知道e和</p>
<p><img src="https://bkimg.cdn.bcebos.com/formula/679e809a0d964785d0aa4cfcb4218742.svg" alt="img"></p>
<p>，则很容易计算出d [5] ；</p>
<p>（4）公开整数n和e，秘密保存d [5] ；</p>
<p>（5）将明文m（m&lt;n是一个整数）加密成密文c，加密算法为 [5] </p>
<p><img src="https://bkimg.cdn.bcebos.com/formula/5947116555169dc6fe9e3f5cdf347706.svg" alt="img"></p>
<p>（6）将密文c解密为明文m，解密算法为 [5] </p>
<p><img src="https://bkimg.cdn.bcebos.com/formula/1a8b337167e4d4b2c23855d88ec4c67f.svg" alt="img"></p>
<p>然而只根据n和e（注意：不是p和q）要计算出d是不可能的。因此，任何人都可对明文进行加密，但只有授权用户（知道d）才可对密文解密 [5] 。</p>
<p>——百度百科</p>
</blockquote>
<p>再回看题目给的代码，发现它已经把私钥都给我们了，于是根据算法直接解密吧：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">c = <span class="number">12786994906832886031173089454539830225421640443805160963440942546071910322282773910135388020414967368794768319321460372875327006020157548651622969466323905189761834455201291838045352561790791600881627927594863932384116760236609096504346833060291203939690475993692410973499329433726175351882818053841075210942250478835641657575946226612389154039920962506062857726362447590070697348315291411570674334126096132112365825105842643843896421848410966564321518660727994853036555116782763422065173850238826345797198901647320210828033061322523971939726188821545177029535860881611210887039411052848607563035583276075332653567834</span></span><br><span class="line">p = <span class="number">161719691876167304386300539654699854745688262478039691942271426308613132466937889105173933022986654040443219708318126579048996288583272346602042650222520127626611975688909019632479930508343350314542889627461529623000987307169157443265879212155437165660477850241678385286601587538517091605374764970915451201471</span></span><br><span class="line">q = <span class="number">131679150542057883837006988923642169851011066771905140540444762603374903776910595387305441746623070810587630852182725227845916400198693359271062585498062084740896090668288333576457754165324164735966791029516030696195703650691726650990903496820364700241229117883279657833543807874786274886417501405960125022153</span></span><br><span class="line">n = <span class="number">21295111652177049852547386222656846645616549922902112221240647622752994625687294739828756977846793220378085163155773051922086862363248151399852421844018730199066331944608000906761112010951655369036878807145188296884981895884278542857120225505310980291226351653588799242142355376939447934804833830853036785704513557039806761305316841740131204576974408869765714675230132247412774215945663807730855436503625577606009921411947891570324777735323489304604987902364932089976811865007609745513534209603256719511305317200247134396733168695387708420206468160279271453425776388025425790010391137010735121696446552257334341187063</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">k = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span>((((p<span class="number">-1</span>)*(q<span class="number">-1</span>)*k+<span class="number">1</span>)) % e != <span class="number">0</span>):</span><br><span class="line">    k += <span class="number">1</span></span><br><span class="line">d = ((p<span class="number">-1</span>)*(q<span class="number">-1</span>)*k+<span class="number">1</span>)//e</span><br><span class="line"></span><br><span class="line">dm = pow(c, d, n)</span><br><span class="line">print(long_to_bytes(dm))</span><br></pre></td></tr></table></figure>

<p>得到flag：<code>moectf&#123;uLl_f1Nd_th@t_RsA_1s_1nte2eSt1nG&#125;</code></p>
<p><em>啊，神秘的非对称加密</em></p>
<br>

<hr>
<h2 id="easy木大定理"><a href="#easy木大定理" class="headerlink" title="easy木大定理"></a>easy木大定理</h2><blockquote>
<p>200points</p>
<p>听说欧拉定理是rsa的基础呢</p>
</blockquote>
<p>附件中代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *   &lt;-- 注意：这个库我装载不了，官方也好像弃用了，于是我用了其他的库和函数来代替它 下同</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">phi</span>(<span class="params">p</span>):</span></span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span> , p):</span><br><span class="line">        <span class="keyword">if</span> gcd(p , i) == <span class="number">1</span>:</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> count</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">padding</span>(<span class="params">m</span>):</span></span><br><span class="line">    lenth = <span class="number">8</span> - len(m) % <span class="number">8</span></span><br><span class="line">    <span class="keyword">return</span> m + chr(lenth).encode() * lenth</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enc_block</span>(<span class="params">m , n , e</span>):</span></span><br><span class="line">    <span class="keyword">return</span> pow(m ,e , n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enc</span>(<span class="params">plain , nlist , e</span>):</span></span><br><span class="line">    m = padding(plain)</span><br><span class="line">    c = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(m) // <span class="number">8</span>):</span><br><span class="line">        c.append(enc_block(bytes_to_long(m[i*<span class="number">8</span>:i*<span class="number">8</span>+<span class="number">8</span>]) , nlist[i%len(nlist)] , e))</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dec</span>(<span class="params">clist , nlist , e</span>):</span></span><br><span class="line">    m = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(clist)):</span><br><span class="line">        m += long_to_bytes(pow(clist[i] , invert(e , phi(nlist[i%len(nlist)])) , nlist[i%len(nlist)]))</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">128</span>)</span><br><span class="line">q = getPrime(<span class="number">128</span>)</span><br><span class="line">r = getPrime(<span class="number">128</span>)</span><br><span class="line">e = getPrime(<span class="number">64</span>)</span><br><span class="line">nlist = [p , q  , p*q , q*r ,  p*q*r , p*p , p*p*r , q*q*q*p*r , r]</span><br><span class="line">print(<span class="string">&#x27;p =&#x27;</span> , p)</span><br><span class="line">print(<span class="string">&#x27;q =&#x27;</span> , q)</span><br><span class="line">print(<span class="string">&#x27;r =&#x27;</span> , r)</span><br><span class="line">print(<span class="string">&#x27;e =&#x27;</span> , e)</span><br><span class="line">print(enc(flag , nlist , e))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#p = 271025496017434332035320753340939587753</span></span><br><span class="line"><span class="comment">#q = 187062615477826075738455044071781085709</span></span><br><span class="line"><span class="comment">#r = 264397348115983548873673645475684815267</span></span><br><span class="line"><span class="comment">#e = 14436419940785226047</span></span><br><span class="line"><span class="comment">#[79782042635181913487761772413093921465, 107105488436932482013906334623869740338, 3509151100641734446618186842681522103526622068330460330390027482293268995394, 44354713639146606352347981311754502280362685562054139875438634255351381551517, 7171349658970005627908887988207921395623970773677857712592896110910571654197390635906137916220127293111749219597125, 58862655174446752862856422604624433087552362298932033062526721301095820867360, 3090488671394364096763874366619864017834796691989365240435579932872211345861700323240994096818599239942176113337679, 53242497022725707314805904569598522652513669651433432760834670648465562534867455830168023766511087312372214790085176655801545624726261017112578045706948404488664028834533439478580770424859450, 81020119172085603626908922002571725744]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>题目给出了 <code>dec(clist , nlist , e)</code> 的解密算法，但是运行起来特别慢，很难在短时间内得到结果，且主要耗时在<code>phi(p)</code>上，即计算1~p内与p互质数的个数，考虑优化这个算法。</p>
<p>根据题目的提示“欧拉定理”，查到相应的知识如下：</p>
<blockquote>
<p><strong>欧拉定理：</strong></p>
<p>在<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%95%B0%E8%AE%BA">数论</a>中，<strong>欧拉定理,**（也称<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E8%B4%B9%E9%A9%AC"><strong>费马</strong></a></strong>-欧拉定理**）是一个关于同余的性质。欧拉定理表明，若n,a为<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%AD%A3%E6%95%B4%E6%95%B0">正整数</a>，且n,a<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E4%BA%92%E8%B4%A8">互质</a>，则:</p>
<p><img src="https://bkimg.cdn.bcebos.com/formula/3da31f29a8615a130216bdf28ccf3321.svg" alt="img"></p>
<p><strong>欧拉函数：</strong></p>
<p>通式：</p>
<p><img src="https://bkimg.cdn.bcebos.com/formula/ba40ed514646510df8a1033ff30701aa.svg" alt="img"></p>
<p> (其中p1, p2……pn为x的所有<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E8%B4%A8%E5%9B%A0%E6%95%B0/6192269">质因数</a>，x是不为0的整数)</p>
<p>定义 φ(1)=1（和1<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E4%BA%92%E8%B4%A8">互质</a>的数(小于等于1)就是1本身）。</p>
<p>注意：每种质因数只有一个。</p>
<p>若n是质数p的k次幂，</p>
<p><img src="https://bkimg.cdn.bcebos.com/formula/b843a8b241f76d7068e96630fc384bb9.svg" alt="img"></p>
<p>，因为除了p的倍数外，其他数都跟n互质。</p>
<p>比如12=2<em>2</em>3那么φ（12）=φ（4<em>3）=φ（2^2</em>3^1）=（2^2-2^1）*（3^1-3^0）=4</p>
<p>设n为正整数，以 φ(n)表示不超过n且与n互素的正整数的个数，称为n的欧拉函数值</p>
<p>φ：N→N，n→φ(n)称为欧拉函数。</p>
<p>欧拉函数是<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E7%A7%AF%E6%80%A7%E5%87%BD%E6%95%B0">积性函数</a>——若m,n互质，</p>
<p><img src="https://bkimg.cdn.bcebos.com/formula/312031d1a76fa578eb4ef166530937fa.svg" alt="img"></p>
<p>特殊性质：当n为奇质数时，</p>
<p><img src="https://bkimg.cdn.bcebos.com/formula/5047f2bc6e623027b7707e6c51adc92f.svg" alt="img"></p>
<p>, 证明与上述类似。</p>
<p>若n为质数则</p>
<p><img src="https://bkimg.cdn.bcebos.com/formula/25e9558d577009b1b8b56f9a103b2321.svg" alt="img"></p>
</blockquote>
<p>这样就可以优化<code>phi(p)</code>，写出更快的<code>phi2(p)</code>如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_</span>(<span class="params">a, b</span>):</span><span class="comment"># 改进欧几里得算法求线性方程的x与y</span></span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        k = a // b</span><br><span class="line">        remainder = a % b</span><br><span class="line">        x1, y1 = get_(b, remainder)</span><br><span class="line">        x, y = y1, x1 - k * y1</span><br><span class="line">    <span class="keyword">return</span> x, y</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">invert</span>(<span class="params">a,b</span>):</span> </span><br><span class="line">    <span class="comment"># 将初始b的绝对值进行保存</span></span><br><span class="line">    <span class="keyword">if</span> b &lt; <span class="number">0</span>:</span><br><span class="line">        m = abs(b)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        m = b</span><br><span class="line">    flag = np.gcd(a, b)</span><br><span class="line">    <span class="comment"># 判断最大公约数是否为1，若不是则没有逆元</span></span><br><span class="line">    <span class="keyword">if</span> flag == <span class="number">1</span>:</span><br><span class="line">        x, y = get_(a, b)</span><br><span class="line">        <span class="keyword">return</span> x % m  <span class="comment"># 对于Python &#x27;%&#x27;就是求模运算，因此不需要&#x27;+m&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">invert2</span>(<span class="params">a,b</span>):</span> </span><br><span class="line">    m = <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span>(np.gcd(a,m)!=<span class="number">1</span>):</span><br><span class="line">        m += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> (a//b)%m</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">invert3</span>(<span class="params">a,m</span>):</span><span class="comment">#这个扩展欧几里得算法求模逆</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> np.gcd(a,m)!=<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    u1,u2,u3 = <span class="number">1</span>,<span class="number">0</span>,a</span><br><span class="line">    v1,v2,v3 = <span class="number">0</span>,<span class="number">1</span>,m</span><br><span class="line">    <span class="keyword">while</span> v3!=<span class="number">0</span>:</span><br><span class="line">        q = u3//v3</span><br><span class="line">        v1,v2,v3,u1,u2,u3 = (u1-q*v1),(u2-q*v2),(u3-q*v3),v1,v2,v3</span><br><span class="line">    <span class="keyword">return</span> u1%m</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">phi</span>(<span class="params">p</span>):</span></span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    print(p)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, p):</span><br><span class="line">        <span class="keyword">if</span> np.gcd(p, i) == <span class="number">1</span>:</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> count</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">padding</span>(<span class="params">m</span>):</span></span><br><span class="line">    lenth = <span class="number">8</span> - len(m) % <span class="number">8</span></span><br><span class="line">    <span class="keyword">return</span> m + chr(lenth).encode() * lenth</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enc_block</span>(<span class="params">m, n, e</span>):</span></span><br><span class="line">    <span class="keyword">return</span> pow(m, e, n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enc</span>(<span class="params">plain, nlist, e</span>):</span></span><br><span class="line">    m = padding(plain)</span><br><span class="line">    c = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(m) // <span class="number">8</span>):</span><br><span class="line">        c.append(enc_block(bytes_to_long(</span><br><span class="line">            m[i*<span class="number">8</span>:i*<span class="number">8</span>+<span class="number">8</span>]), nlist[i % len(nlist)], e))</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">phi2</span>(<span class="params">i</span>):</span></span><br><span class="line">    <span class="keyword">if</span> (i == <span class="number">0</span>):</span><br><span class="line">        <span class="keyword">return</span> p<span class="number">-1</span></span><br><span class="line">    <span class="keyword">elif</span> (i == <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">return</span> q<span class="number">-1</span></span><br><span class="line">    <span class="keyword">elif</span> (i == <span class="number">2</span>):</span><br><span class="line">        <span class="keyword">return</span> (p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">    <span class="keyword">elif</span> (i == <span class="number">3</span>):</span><br><span class="line">        <span class="keyword">return</span> (q<span class="number">-1</span>)*(r<span class="number">-1</span>)</span><br><span class="line">    <span class="keyword">elif</span> (i == <span class="number">4</span>):</span><br><span class="line">        <span class="keyword">return</span> (q<span class="number">-1</span>)*(r<span class="number">-1</span>)*(p<span class="number">-1</span>)</span><br><span class="line">    <span class="keyword">elif</span> (i == <span class="number">5</span>):</span><br><span class="line">        <span class="keyword">return</span> (p<span class="number">-1</span>)*(p)</span><br><span class="line">    <span class="keyword">elif</span> (i == <span class="number">6</span>):</span><br><span class="line">        <span class="keyword">return</span> (p<span class="number">-1</span>)*(p)*(r<span class="number">-1</span>)</span><br><span class="line">    <span class="keyword">elif</span> (i == <span class="number">7</span>):</span><br><span class="line">        <span class="keyword">return</span> (q<span class="number">-1</span>)*(q)*(q)*(p<span class="number">-1</span>)*(r<span class="number">-1</span>)</span><br><span class="line">    <span class="keyword">elif</span> (i == <span class="number">8</span>):</span><br><span class="line">        <span class="keyword">return</span> r<span class="number">-1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dec</span>(<span class="params">clist, nlist, e</span>):</span></span><br><span class="line">    m = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(clist)):</span><br><span class="line"></span><br><span class="line">        m += long_to_bytes(pow(clist[i], invert3(e,phi2(i % len(nlist))), nlist[i % len(nlist)]))</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># p = getPrime(128)</span></span><br><span class="line"><span class="comment"># q = getPrime(128)</span></span><br><span class="line"><span class="comment"># r = getPrime(128)</span></span><br><span class="line"><span class="comment"># e = getPrime(64)</span></span><br><span class="line">p = <span class="number">271025496017434332035320753340939587753</span></span><br><span class="line">q = <span class="number">187062615477826075738455044071781085709</span></span><br><span class="line">r = <span class="number">264397348115983548873673645475684815267</span></span><br><span class="line">e = <span class="number">14436419940785226047</span></span><br><span class="line">nlist = [p, q, p*q, q*r,  p*q*r, p*p, p*p*r, q*q*q*p*r, r]</span><br><span class="line">print(<span class="string">&#x27;p =&#x27;</span>, p)</span><br><span class="line">print(<span class="string">&#x27;q =&#x27;</span>, q)</span><br><span class="line">print(<span class="string">&#x27;r =&#x27;</span>, r)</span><br><span class="line">print(<span class="string">&#x27;e =&#x27;</span>, e)</span><br><span class="line"></span><br><span class="line">c = [<span class="number">79782042635181913487761772413093921465</span>, <span class="number">107105488436932482013906334623869740338</span>, <span class="number">3509151100641734446618186842681522103526622068330460330390027482293268995394</span>, <span class="number">44354713639146606352347981311754502280362685562054139875438634255351381551517</span>, <span class="number">7171349658970005627908887988207921395623970773677857712592896110910571654197390635906137916220127293111749219597125</span>,</span><br><span class="line">     <span class="number">58862655174446752862856422604624433087552362298932033062526721301095820867360</span>, <span class="number">3090488671394364096763874366619864017834796691989365240435579932872211345861700323240994096818599239942176113337679</span>, <span class="number">53242497022725707314805904569598522652513669651433432760834670648465562534867455830168023766511087312372214790085176655801545624726261017112578045706948404488664028834533439478580770424859450</span>, <span class="number">81020119172085603626908922002571725744</span>]</span><br><span class="line">print(dec(c, nlist, e))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li><input disabled type="checkbox"> 注：<code>gmpy2</code>库不知道什么原因我装载不了，官方也好像弃用了，于是我用了<code>Crypto.Util.number</code>、<code>numpy</code>来代替它，然而<code>invert</code>好像还是没有，就搞了一个轮子……求助有没有更好的解决方法。</li>
</ul>
<p>运行得到flag：<code>moectf&#123;EULEREu1erEule2Eu1erEulerEyoulerEU1e2Mud@MuDaMudamuDaMudaMUDA&#125;</code></p>
<blockquote>
<p>欧拉欧拉欧拉欧拉欧拉欧拉欧拉木大木大木大！</p>
</blockquote>
<ul>
<li><input disabled type="checkbox"> 为什么木大呢🤔</li>
</ul>
<br>

<hr>
<p>后面的题就没有做了</p>
<br>

<hr>
<p><em>未完并不一定待续……</em></p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Framist
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://framist.github.io/2020/10/12/%E3%80%90moeCTF%E9%A2%98%E8%A7%A3-0x04%E3%80%91Crypto/" title="【moeCTF题解-0x04】Crypto">https://framist.github.io/2020/10/12/【moeCTF题解-0x04】Crypto/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/CTF/" rel="tag"># CTF</a>
              <a href="/tags/Python/" rel="tag"># Python</a>
              <a href="/tags/Crypto/" rel="tag"># Crypto</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/10/12/%E3%80%90moeCTF%E9%A2%98%E8%A7%A3-0x03%E3%80%91Algorithm/" rel="prev" title="【moeCTF题解-0x03】Algorithm">
      <i class="fa fa-chevron-left"></i> 【moeCTF题解-0x03】Algorithm
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/10/15/%E3%80%90moeCTF%E9%A2%98%E8%A7%A3-0x05%E3%80%91Misc/" rel="next" title="【moeCTF题解-0x05】Misc">
      【moeCTF题解-0x05】Misc <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E3%80%90moeCTF%E9%A2%98%E8%A7%A3-0x04%E3%80%91Crypto"><span class="nav-number">1.</span> <span class="nav-text">【moeCTF题解-0x04】Crypto</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Classic-Crypto"><span class="nav-number">2.</span> <span class="nav-text">Classic Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%A7%E5%B8%9D%E7%9A%84%E5%BE%81%E7%A8%8B-1"><span class="nav-number">2.1.</span> <span class="nav-text">大帝的征程#1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%A7%E5%B8%9D%E7%9A%84%E5%BE%81%E7%A8%8B-2"><span class="nav-number">2.2.</span> <span class="nav-text">大帝的征程#2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%96%E9%9D%A2%E7%9A%84%E4%B8%96%E7%95%8C"><span class="nav-number">2.3.</span> <span class="nav-text">外面的世界</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%A7%E5%B8%9D%E7%9A%84%E5%BE%81%E7%A8%8B-3"><span class="nav-number">2.4.</span> <span class="nav-text">大帝的征程#3</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%A7%E5%B8%9D%E7%9A%84%E5%BE%81%E7%A8%8B-%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A"><span class="nav-number">2.5.</span> <span class="nav-text">大帝的征程#维吉尼亚</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%A7%E5%B8%9D%E7%9A%84%E5%BE%81%E7%A8%8B-%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9AEx"><span class="nav-number">2.6.</span> <span class="nav-text">大帝的征程#维吉尼亚Ex</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Crypto"><span class="nav-number">3.</span> <span class="nav-text">Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#crypto%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97"><span class="nav-number">3.1.</span> <span class="nav-text">crypto入门指北</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Stream"><span class="nav-number">3.2.</span> <span class="nav-text">Stream</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#easycrypto"><span class="nav-number">3.3.</span> <span class="nav-text">easycrypto</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#simple-number-theory"><span class="nav-number">3.4.</span> <span class="nav-text">simple_number_theory</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#rsa-begin"><span class="nav-number">3.5.</span> <span class="nav-text">rsa_begin</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#easy%E6%9C%A8%E5%A4%A7%E5%AE%9A%E7%90%86"><span class="nav-number">3.6.</span> <span class="nav-text">easy木大定理</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Framist</p>
  <div class="site-description" itemprop="description">框架主义者的小窝</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">34</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">28</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/framist" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;framist" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:framist@163.com" title="E-Mail → mailto:framist@163.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://blog.csdn.net/weixin_47102975" title="CSDN → https:&#x2F;&#x2F;blog.csdn.net&#x2F;weixin_47102975" rel="noopener" target="_blank"><i class="fas fa-angle-right fa-fw"></i>CSDN</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://framist.github.io/2020/10/11/%E6%88%91%E8%BA%AB%E8%BE%B9%E7%9A%84CS%E5%A4%A7%E4%BD%AC%E4%BB%AC/" title="https:&#x2F;&#x2F;framist.github.io&#x2F;2020&#x2F;10&#x2F;11&#x2F;%E6%88%91%E8%BA%AB%E8%BE%B9%E7%9A%84CS%E5%A4%A7%E4%BD%AC%E4%BB%AC&#x2F;">我身边的大佬们</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://yuexiavqiufeng.github.io/" title="https:&#x2F;&#x2F;yuexiavqiufeng.github.io&#x2F;" rel="noopener" target="_blank">yuexiavqiufeng</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://github.com/framist" title="https:&#x2F;&#x2F;github.com&#x2F;framist" rel="noopener" target="_blank">广告位招租</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-at"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Framist</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div><script>
    let body = document.getElementsByTagName('body')[0];
    body.addEventListener('click', (e) => {
        let contentArr = ['欧拉~','ˋ( ° ▽、° ) ','RGB!','_(:з」∠)_','哼','?','¿框架?','QAQ','bing的随机图片API貌似崩了，背景白色先将就吧',':3'];
        let randomNum = function (n) {
            return Math.floor(Math.random() * n)
        }
        let span = document.createElement('span');
        span.innerHTML = `${contentArr[randomNum(contentArr.length)]}`;
        span.style.color = `rgb(${randomNum(256)},${randomNum(256)},${randomNum(256)})`;
        span.style.position = 'absolute';
        span.style.top = `${e.pageY}px`;
        span.style.left = `${e.pageX}px`;
        span.style.transition = 'all 1s ease';
        span.style.zIndex = 20000;
        body.appendChild(span)
        setTimeout(()=>{
            span.style.top = span.offsetTop - 25 + 'px';
            span.style.opacity = 0;
            setTimeout(()=>{span.remove()},700)
        },700)
    })
</script>




<script type="text/javascript" color="255,255,255" pointColor='255,255,255' opacity='0.5' zIndex="-1" count="233" src="https://cdn.jsdelivr.net/npm/canvas-nest.js@1/dist/canvas-nest.js"></script>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>















  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : '267a9d4a89b9b72b2229',
      clientSecret: '2dba1f14d21da707ed6c4497fecc05d6178b4fa3',
      repo        : 'blog-comment',
      owner       : 'framist',
      admin       : ['framist'],
      id          : '831f46207d1de0e4016f4f88876e8d89',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

</body>
</html>
